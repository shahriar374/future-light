<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org" lang="en"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head
	th:insert="~{layout :: head(title='All users', localcss='allusers.css')}"></head>

<body>
	<!-- Navbar -->
	<th:block th:replace="~{layout :: navbar}"></th:block>

	<!-- Main Body Start -->
	<div class="container">
		<div class="row text-center">

			<h1 class="mt-5 poppins-bold">All users</h1>

			<!-- Alerts -->
			<div th:if="${param.updated}" class="alert alert-success alert-dismissible fade show text-start" role="alert">
				<p>Information updated</p>
				<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
	  		</div>


			<table class="table table-dark mt-5">
				<thead>
					<tr>
						<th scope="col">Username</th>
						<th scope="col">Full Name</th>
						<th scope="col">Email</th>
						<th scope="col">Gender</th>
						<th scope="col">Age</th>
						<th scope="col"></th>
					</tr>
				</thead>
				<tbody>
				
					<tr th:each="user, iterStat : ${users}">
						<td th:text="${user.username}"></td>
						<td th:text="${user.fullname}"></td>
						<td th:text="${user.email}"></td>
						<td th:text="${#strings.capitalize(user.gender)}"></td>
						<td th:text="${user.age}"></td>
						<td>
							<!-- Modal trigger button -->
							<button class="btn btn-primary" data-bs-toggle="modal" th:data-bs-target="'#exampleModal' + ${iterStat.index}">
										<svg class="feather">
											<use th:href="@{/feather/feather-sprite.svg#edit}" /></svg>
										Edit
							</button>
							
							<!-- Modal -->
							<div class="modal fade" th:id="'exampleModal' + ${iterStat.index}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
							  <div class="modal-dialog modal-dialog-centered">
							    <div class="modal-content">
							      <div class="modal-header" data-bs-theme="dark" >
							        <h1 class="modal-title fs-5" id="exampleModalLabel">Edit information</h1>
							        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
							      </div>
							      <div class="modal-body">
							        
									<!-- Edit form start -->
									<form class="text-start my-5" th:action="@{/allusers/update}" method="post">
										<div class="mb-3">
											<label for="fullname" class="form-label">Full Name</label> <input
												type="text" class="form-control dash-inp" name="fullname"
												id="fullname" th:value="${user.fullname}" required>
										</div>
										<div class="mb-3">
											<input
												type="hidden" class="form-control dash-inp" name="username"
												id="username" th:value="${user.username}" required>
										</div>
										<div class="mb-3">
											<label for="email" class="form-label">Email</label> <input
												type="email" class="form-control dash-inp" name="email"
												id="email" th:value="${user.email}" required>
										</div>
										<div class="mb-3">
											<label for="gender" class="form-label">Gender</label> <select
												class="form-control dash-inp" name="gender" id="gender" required>
												
												<option th:if="${user.gender == 'male'}" value="male" selected>Male</option>
												<option th:if="${user.gender == 'male'}" value="female">Female</option>
												
												<option th:if="${user.gender == 'female'}" value="male">Male</option>
												<option th:if="${user.gender == 'female'}" value="female" selected>Female</option>
												
											</select>
										</div>
										<div class="mb-3">
											<label for="age" class="form-label">Age</label> <input
												type="number" min="1" max="150" class="form-control dash-inp"
												name="age" id="age" th:value="${user.age}" required>
										</div>
										<div class="mb-3">
											<label for="password" class="form-label">Password</label> <input
												placeholder="Enter new password" type="password" minlength="8"
												maxlength="128" class="form-control dash-inp" name="password"
												id="password" >
										</div>
										<div class="d-flex justify-content-center modal-footer">
											<button type="button" class="btn btn-danger" data-bs-dismiss="modal">
												<svg class="feather">
													<use th:href="@{/feather/feather-sprite.svg#x-circle}" /></svg>
												Close
											</button>
											<button type="submit" class="btn btn-success">
												<svg class="feather">
													<use th:href="@{/feather/feather-sprite.svg#edit}" /></svg>
												Update
											</button>
										</div>
									</form>
									<!-- Edit form end -->
									
							      </div>
							    </div>
							  </div>
							</div>
							<!-- Modal end -->
							
							
							<!-- Delete button -->
							<a th:href="@{/allusers}">
							<button class="btn btn-danger">
										<svg class="feather">
											<use th:href="@{/feather/feather-sprite.svg#user-x}" /></svg>
										Delete
							</button>
							</a>
						</td>
						
					</tr>

				</tbody>
			</table>

		</div>
	</div>
	<!-- Main Body End -->

	<!-- BootStrap JS -->
	<th:block th:replace="~{layout :: bootstrapjs}"></th:block>
</body>
</html>